(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7235:function(e,o,n){Promise.resolve().then(n.bind(n,3981))},3981:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return RootLayout}});var r=n(7437);n(9841);var t=n(2265),i=n(6635),l=n(1396),s=n.n(l),c=n(6951),navbar=()=>{let{isLoggedIn:e,isAdmin:o,startLogin:n,logout:l}=(0,c.a)(),[a,d,u]=(0,i.Z)(["jwt"]);a.jwt;let[g,h]=(0,t.useState)(e);return(0,t.useEffect)(()=>{h(e)},[]),(0,r.jsx)("header",{children:(0,r.jsxs)("nav",{className:"navbar navbar-dark bg-dark",children:[(0,r.jsx)("img",{src:"/img/website-logo.png",alt:"CodeDudes",className:"nav-logo"}),(0,r.jsxs)("ul",{className:"nav-items",children:[(0,r.jsx)("li",{children:(0,r.jsx)(s(),{href:"/",children:"Home"})}),e&&o&&(0,r.jsx)("li",{children:(0,r.jsx)(s(),{href:"/admin",children:"Admin"})}),e&&(0,r.jsx)("li",{children:(0,r.jsx)(s(),{href:"/profile",children:"Profile"})}),e?(0,r.jsx)("li",{onClick:function(){console.log("logout clicked"),l(),console.log("logout complete")},children:"Logout"}):(0,r.jsx)("li",{onClick:function(){console.log("login clicked"),n(),console.log("login clicked")},children:"Login"})]})]})})};function FooterComponent(){return(0,r.jsx)("footer",{children:(0,r.jsx)("div",{className:"footer-content",children:(0,r.jsx)("section",{className:"footer-base",children:(0,r.jsxs)("div",{className:"footer-legal",children:[(0,r.jsx)("div",{className:"footer-legal-copyright",children:"Copyright \xa9 2023 CodeDudes"}),(0,r.jsxs)("div",{className:"footer-legal-links",children:[(0,r.jsx)("a",{href:"#",children:"Privacy Policy"}),(0,r.jsx)("a",{href:"#",children:"Terms of Use"})]})]})})})})}function RootLayout(e){let{children:o}=e;return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{children:(0,r.jsxs)(c.H,{children:[(0,r.jsx)(navbar,{}),o,(0,r.jsx)(FooterComponent,{})]})})})}n(2916)},6951:function(e,o,n){"use strict";n.d(o,{H:function(){return AuthProvider},a:function(){return useAuth}});var r=n(7437),t=n(6635),i=n(848),getURLWithQueryParams=(e,o)=>{let n=Object.entries(o).map(e=>{let[o,n]=e;return"".concat(o,"=").concat(encodeURIComponent(n))}).join("&");return"".concat(e,"?").concat(n)};let GetLinkedinLoginUrl=e=>getURLWithQueryParams("https://www.linkedin.com/oauth/v2/authorization",{response_type:"code",client_id:"77k9klio9keegq",redirect_uri:"https://learn.codedudes.dev/login/callback",scope:"profile email openid",state:e}),l=Object.freeze({SESSION_STORAGE_OAUTH_STATE_KEY:"oauth_state",SESSION_STORAGE_OAUTH_LOGIN_PROVIDER_KEY:"login_provider_key",OAUTH_PROVIDER_LINKEDIN:"linkedin",COOKIE_AUTH_TOKEN_KEY:"jwt"});var s=n(4033),c=n(2265);let a="https://api.codedudes.dev",d=(0,c.createContext)({isLoggedIn:!1,isAdmin:!1,startLogin:()=>{},login:(e,o,n)=>{},logout:()=>{}}),AuthProvider=e=>{let{children:o}=e;console.log("base url",a);let n=(0,s.useRouter)(),[u,g,h]=(0,t.Z)(["jwt"]),[_,E]=(0,c.useState)(!1),[f,O]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{E(!!u.jwt)},[]),(0,r.jsx)(d.Provider,{value:{isLoggedIn:_,isAdmin:f,startLogin:()=>{console.log("startLogin");var e=(0,i.Z)(),o=GetLinkedinLoginUrl(e);window.sessionStorage.setItem(l.SESSION_STORAGE_OAUTH_STATE_KEY,e),window.sessionStorage.setItem(l.SESSION_STORAGE_OAUTH_LOGIN_PROVIDER_KEY,l.OAUTH_PROVIDER_LINKEDIN),console.log("redirect uri",o),window.location.href=o},login:function(e,o){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{e.error?console.log("error logging in ",err):console.log("loggin success")};(async function(){var onError=e=>{r({error:e})};if(!function(e){if(!e)return!1;let o=window.sessionStorage.getItem(l.SESSION_STORAGE_OAUTH_STATE_KEY);return!!o&&o===e}(o)){onError("Error logging in. State mismatch");return}let t=window.sessionStorage.getItem(l.SESSION_STORAGE_OAUTH_LOGIN_PROVIDER_KEY);if(!(t&&t===l.OAUTH_PROVIDER_LINKEDIN)){onError("Error logging in. Provider not supported");return}try{let o=await fetch(a+"/login/linkedin",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({code:e,redirectUri:"https://learn.codedudes.dev/login/callback"})});if(!o.ok){onError("Error logging in. Unable to log you in right now");return}E(!0),O(!1)}catch(e){onError("Error loggin in. Try again");return}n.push("/")})()},logout:()=>{h("jwt"),E(!1),O(!1),console.log("logout")}},children:o})},useAuth=()=>(0,c.useContext)(d)},9841:function(){}},function(e){e.O(0,[390,470,971,472,744],function(){return e(e.s=7235)}),_N_E=e.O()}]);